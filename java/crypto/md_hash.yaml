rules:
- id: md_hash
  severity: WARNING
  metadata:
    author: Maurizio Siddu
    references:
      - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/04-Testing_for_Weak_Encryption
      - https://cwe.mitre.org/data/definitions/328.html
    category: security
  message: >-
    This Java application uses a weak hashing algorithm, the data hashed using Message-Digest hashing
    algorithms results vulnerable to various cryptographic attacks, which could allow to retrieve
    its plain-text value. 
    It is recommended to avoid the use of Message-Digest hashing algorithms.
  languages: [java]
  patterns:
    - pattern: |
        java.security.MessageDigest.getInstance($HASH, ...);
    - metavariable-regex:
        metavariable: $HASH
        regex: MD(2-6)
    - pattern: |
        $DU.$HASH.digest(...)
    - metavariable-regex:
        metavariable: $HASH
        regex: getMd(2-6)Digest.*


